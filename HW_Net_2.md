#  Решение домашнего задания к занятию "3.7. Компьютерные сети, лекция 2"
1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?
* Linux

```
# ip link
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: tunl0@NONE: <NOARP> mtu 1480 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ipip 0.0.0.0 brd 0.0.0.0
3: sit0@NONE: <NOARP> mtu 1480 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/sit 0.0.0.0 brd 0.0.0.0
28: eth0@if29: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT group default
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0
```

* Windows

```
>ipconfig

Настройка протокола IP для Windows


Неизвестный адаптер OpenVPN Wintun:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер Ethernet Ethernet 3:

   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::2533:d391:e9ac:85f7%6
   IPv4-адрес. . . . . . . . . . . . : тут был ip адрес)
   Маска подсети . . . . . . . . . . : 255.255.255.0
   Основной шлюз. . . . . . . . . : тут был ip шлюза)

Неизвестный адаптер OpenVPN TAP-Windows6:

   Состояние среды. . . . . . . . : Среда передачи недоступна.
   DNS-суффикс подключения . . . . . :

Адаптер Ethernet vEthernet (WSL):

   DNS-суффикс подключения . . . . . :
   Локальный IPv6-адрес канала . . . : fe80::74fa:d2ae:9ecd:c089%38
   IPv4-адрес. . . . . . . . . . . . : 172.20.144.1
   Маска подсети . . . . . . . . . . : 255.255.240.0
   Основной шлюз. . . . . . . . . :
```

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?
* Изпользуется протокол LLDP. Пакет называется lldpd. Чтобы установить его нужно использовать команду представленную ниже:

```
# apt install lldpd
```

* Для обнаружения соседей можно использовать следующую команду:

```
$ sudo lldpcli show neighbors
```

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

* Технология называется VLAN (Virtual Local Area Network).
* Для того чтобы можно было настроить VLAN на ubuntu необходимо установить пакет vlan 

```
# apt install vlan
```

* Привет конфига /etc/network/interfaces

```
auto eth0@if146.20
iface eth0@if146.20 inet dhcp
vlan-raw-device eth0@if146
```

* Также vlan можно настроить через утилиту ip. Например:
```
# ip link add link eth0 name eth0.20 type vlan id 20
```

* Затем нужно присвоить ip и активировать интерфейс:

```
# ip addr add 172.16.20.109/24 brd 172.16.20.255 dev eth0.20
# ip link set dev eth0.20 up
```

4 Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

0 - balance-rr - (round-robin) - режим циклического выбора активного интерфейса для исходящего трафика (рекомендован для включения по умолчанию, не требует применения специальных коммутаторов);

1 - active-backup - активен только один интерфейс, остальные в режиме горячей замены (самый простой режим, работает с любым оборудованием, не требует применения специальных коммутаторов);

2 - balance-xor - режим, в котором каждый получатель закрепляется за одним из физических интерфейсов, который выбирается по специальной формуле (не требует применения специальных коммутаторов);

3 - broadcast - трафик идет через все интерфейсы одновременно (примитивный и потенциально конфликтный режим);

4 - 802.3ad - (dynamic link aggregation) - в группу объединяются одинаковые по скорости и режиму интерфейсы. Все физические интерфейсы используются одновременно в соответствии со спецификацией IEEE 802.3ad. Для реализации этого режима необходима поддержка на уровне драйверов сетевых карт и коммутатор, поддерживающий стандарт IEEE 802.3ad (коммутатор требует отдельной настройки);

5 - balance-tlb - (adaptive transmit load balancing) - исходящий трафик распределяется в соответствии с текущей нагрузкой (с учетом скорости) на интерфейсах (для данного режима необходима его поддержка в драйверах сетевых карт);

6 - balance-alb - (adaptive load balancing) - включает в себя balance-tlb, плюс балансировку на приём (rlb) для IPv4 трафика и не требует применения специальных коммутаторов (балансировка на приём достигается на уровне протокола ARP, перехватом ARP ответов локальной системы и перезаписью физического адреса на адрес одного из сетевых интерфейсов, в зависимости от загрузки).

```
network:
    ethernets:
        eth1:          
	    dhcp4: no
	eth0:
            dhcp4: no

    bonds:
        bond1:
          interfaces:
              - eth1
              - eth0
          dhcp4: no
          addresses: [x.x.x.x/22]
          gateway4: x.x.x.x
          nameservers:
            addresses: [8.8.8.8, 1.1.1.1]
          parameters:
            mode: 802.3ad
            lacp-rate: fast
            mii-monitor-interval: 100
            transmit-hash-policy: layer2+3
            ad-select: bandwidth
          mtu: 1500
```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

* Всего в сети с маской /29 - 8 адресов. Доступно для использования 6.
* Из сети с маской /24 можно получить 8 подсетей
* Адрес сети     Маска           Широковещательный
10.10.10.0    255.255.255.248    10.10.10.7
10.10.10.8    255.255.255.248    10.10.10.15
10.10.10.33   255.255.255.248    10.10.10.39

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.
* Можно использовать сеть 100.64.0.0/26.
* Адрес сети     Маска           Широковещательный
            lacp-rate: fast
            mii-monitor-interval: 100
            transmit-hash-policy: layer2+3
            ad-select: bandwidth
          mtu: 1500
```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

* Всего в сети с маской /29 - 8 адресов. Доступно для использования 6.
* Из сети с маской /24 можно получить 8 подсетей
* Адрес сети     Маска           Широковещательный
10.10.10.0    255.255.255.248    10.10.10.7
10.10.10.8    255.255.255.248    10.10.10.15
10.10.10.33   255.255.255.248    10.10.10.39

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

* Можно использовать 100.64.0.0/26 100.64.0.64/26

* Адрес сети     Маска           Широковещательный
 100.64.0.0    255.255.255.192    100.64.0.63
 100.64.0.64   255.255.255.192    100.64.0.127



7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

* В Linux и Windows можно использовать команду


```
# arp -a
```


* Чтобы полностью удалить кеш:


```
# arp -d *
```


* Чтобы удалить одну запись:


```
# arp -d  224.0.0.22
```

